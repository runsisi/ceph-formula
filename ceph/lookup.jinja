{% set base = salt['grains.filter_by']({
    'Debian': {
        'pkgs': ['ceph',],
        'release': 'giant',
        'manage_repo': True,
        'repos': ['ceph.repo',],
    },
    'Redhat': {
        'pkgs': ['ceph',],
        'release': 'giant',
        'manage_repo': True,
        'repos': ['ceph.repo', 'ceph-noarch.repo'],
    },
    'default': {
        'pkgs': ['ceph',],
        'release': 'giant',
        'manage_repo': True,
        'repos': ['ceph.repo',],
    },
}, grain = 'os_family', merge = salt['pillar.get']('ceph:lookup')) %}

{% set config = salt['grains.filter_by']({
    'default': {
        'cluster': 'ceph',

        'fsid': '4574b049-dfd3-49c7-8618-95863f3cb084',
        'authentication_type': 'cephx',
        'mon_initial_members': 'hust,',
        'mon_host': 'hust:6789,',
        'public_network': '10.118.4.0/24',
        'cluster_network': '10.118.4.0/24',

        'osd_pool_default_pg_num': '200',
        'osd_pool_default_pgp_num': '200',
        'osd_pool_default_size': '2',
        'osd_pool_default_min_size': '1',

        'admin_key': 'AQBMGHJTkC8HKhAAJ7NH255wYypgm1oVuV41MA==',
        'admin_key_mode': '0600',
        'mon_key': 'AQATGHJTUCBqIBAA7M2yafV1xctn1pgr3GcKPg==',
        'mon_keyring': '',
        'bootstrap_osd_key': 'AQARG3JTsDDEHhAAVinHPiqvJkUi5Mww/URupw==',
        'bootstrap_mds_key': 'AQCztJdSyNb0NBAASA2yPZPuwXeIQnDJ9O8gVw==',
    },
}, merge = salt['pillar.get']('ceph:lookup')) %}

{% set ceph = salt['grains.filter_by']({
    'brs159': {
        'mon_id': grains['host'],
        'public_addr': '',
        'osds': [{},],
    },
    'default': {
        'mon_id': grains['host'],
        'public_addr': grains['ipv4'][0] + ':6789',
        'osds': [{},],
        
    },
}, grain = 'host', merge = salt['pillar.get']('ceph:lookup')) %}
